<!DOCTYPE html>
<html lang="en">
<%- include('partials/_head') %>
<body class="bg-gray-100">
  <%- include('partials/_header') %>
  <div class="container mx-auto mt-10 p-6 bg-white shadow-md rounded-lg">
    <h2 class="text-3xl font-semibold mb-6 text-center"><%= imapAccount ? 'Edit' : 'Add' %> IMAP Account</h2>
    <% if (message) { %>
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
        <strong class="font-bold">Notice:</strong>
        <span class="block sm:inline"><%= message %></span>
      </div>
    <% } %>
    <form action="<%= imapAccount ? `/account/edit-imap-account/${imapAccount._id}` : '/imap/imap-info' %>" method="POST" class="space-y-4">
      <div>
        <label for="emailAddress" class="block text-sm font-medium text-gray-700">Email Address</label>
        <input type="email" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" id="emailAddress" name="emailAddress" value="<%= imapAccount ? imapAccount.email : '' %>" required>
      </div>
      <div>
        <label for="imapServer" class="block text-sm font-medium text-gray-700">IMAP Server</label>
        <input type="text" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" id="imapServer" name="imapServer" value="<%= imapAccount ? imapAccount.server : '' %>" required>
      </div>
      <div>
        <label for="port" class="block text-sm font-medium text-gray-700">Port</label>
        <input type="number" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" id="port" name="port" value="<%= imapAccount ? imapAccount.port : '' %>" required>
      </div>
      <div>
        <label for="password" class="block text-sm font-medium text-gray-700">Password <%= imapAccount ? '(leave blank to keep current password)' : '' %></label>
        <input type="password" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" id="password" name="password" <%= imapAccount ? '' : 'required' %>>
      </div>
      <div>
        <label for="schedule" class="block text-sm font-medium text-gray-700">Schedule</label>
        <input type="text" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" id="schedule" name="schedule" value="<%= imapAccount ? imapAccount.schedule : '' %>" required>
        <small class="text-gray-500">Example: "0 1 * * *" (Once a day at 1 am)</small>
      </div>
      <div class="flex space-x-4">
        <button type="submit" class="w-1/2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"><%= imapAccount ? 'Update' : 'Add' %> IMAP Account</button>
        <a href="/account/manage" class="w-1/2 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">Cancel</a>
      </div>
    </form>
  </div>
  <%- include('partials/_footer') %>
  <script src="/js/imap-info.js"></script>
</body>
</html>
